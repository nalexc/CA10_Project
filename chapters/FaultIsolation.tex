\chapter{Fault handling and reconfiguration}
\label{chap:faultHandling}
\subsection{Reaction Wheel Reconfiguration}
\label{sec:rwReconfig}
Fault handling in the redundant reaction wheel configuration can be done by isolating which is the reaction wheel where the fault occurred and shutting it off and redistributing the torques to the rest of the reaction wheels. Fault signals emitted by the fault detection modules are handled by the reconfiguration logic. Section \ref{ref:reactConfig} describes the distribution of reaction wheel torque demand between the reaction wheels. When the reconfiguration system receives a fault signal, it redistributes the $\vec{N_{rw}^d}$ torque demand by modifying $\underline{A}_M$ matrix in equation \ref{eq:transmatrix}. The torque demand for the faulty wheel becomes zero, while the sum of reaction wheel torques are controlled to follow $\vec{N_{rw}^d}$.

This reconfiguration/redistribution can be represented by changing the $\underline{A}_M$ columns corresponding to faulty wheels to zero vectors. For example, if a fault occurs in the 3rd reaction wheel, the transformation matrix becomes $\underline{A}_{M,f3}$, as presented in equation \ref{eq:ReactFault}.

\begin{equation}
	\label{eq:ReactFault}
	\underline{A}_{M,f3} = \begin{bmatrix}
		\vec{Axis^{M}_{1}}       & \vec{Axis^{M}_{2}}   & \vec{0}   & \vec{Axis^{M}_{4}} 
	\end{bmatrix} 
\end{equation}

\begin{figure}[H]
	\centering 
	\includegraphics[width=170mm]{figures/reconfig.pdf}	
	\caption{Reconfiguration Control Scheme for Reaction Wheels}
	\label{fig:reconfig}
\end{figure}

\nomenclature[S]{$\underline{A}_{M,fi}$}{Transformation matrix between axis oriented reaction wheel torque and torques in 3 dimensional body frame in case of faulty $i$th reaction wheel}

The pseudo inverse used for transformation between 3D to motor torque is calculated in the same manner as presented in equation \ref{eq:motorTrans}, see equation \ref{eq:motorTransFault}. The torque distribution controller scheme which checks for faults in the motors, is presented in Figure \ref{fig:reconfig}

\begin{equation}
	\label{eq:motorTransFault}
	\underline{A}_{M,f3}^\dagger   = \underline{A}_{M,f3}^T  (\underline{A}_{M,f3} \underline{A}_{M,f3}^T)^{-1}
\end{equation}
%
%\begin{figure}
%	\centering
%	\includegraphics[width=120mm]{figures/residOmega}
%	\caption{Insert caption}
%	\label{fig:residualOmega}
%\end{figure} 

Equation \ref{eq:motorTransReconfig2} presents the reconfigured torque distribution equation.

\begin{equation}
\label{eq:motorTransReconfig2}
\vec{N_{M}^d} = \underline{A}_{M,f3}^\dagger \vec{N_{rw}^d}  
\end{equation}


\input{chapters/angVelFaultReconfig}

\input{chapters/rwStructFaultReconfig}
