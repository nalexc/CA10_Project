\chapter{Fault Detection}

Fault detection deals with detecting system discrepancies, abnormal behaviour. It is the first step towards handling faults. It doesn't necessarily identify the source of the fault, just establishes the fact that a fault has occurred in the system.


\input{chapters/StructuralAnalysis.tex}
\section{Motors fault detection}

\label{sec:structural}
\subsection{Structural Analysis}
Structural analysis studies the interrelation between parameters and variables of the system using constraints between them. It distinguishes known and unknown variables, according to whether they can be measured in the system or not. Then the unknown variables are expressed using the known ones according to the constraints. Structural analysis based residual signal require that unknown variables can be expressed redundantly. One of the constraints is used to express the unknown, the other to verify it. If there's a mismatch between the two, a fault is detected.

In case of fault detection in sensors, one constraint is between the measured and the actual values of a variable. In case of a sensor fault, there can be a considerable difference between the measured and the actual value of a variable.

Assumes that only one fault occurs at any given time, so faults cannot mutually neutralize each other. 

The constraints being used to detect faults in the motor are:

\ref{sec:motor} \todo{reference motor section properly}


\begin{equation}
V_a = R_a * i + k_e \omega
\end{equation}

$L_a$ is negligible

\begin{equation}
k_{t}i  =J\dfrac{d\omega}{dt} + b\omega
\end{equation}

\begin{equation}
\tau = k_t i
\end{equation}

$d_1(\omega, \dot{\omega})$


\subsection{Alternative method for identifying reaction wheel fault}

With enough computational power the faulty reaction wheel can be detected through the calculated reaction wheel output torque, assuming only one reaction wheel is faulty. It is done by calculating the difference between 3D torque demand and actual 3D torque output. 

\begin{equation}
\vec{N}_{rw} = \underline{I}_s \dot{\vec{\omega}}  + \vec{\omega} \times \vec{h_{rw}} - \vec{N_{mt}} - \vec{N_{dist}}
\end{equation}

Then the difference between torque demand and torque output is calculated. The reaction wheel that has the most similar axis orientation to the torque difference is deemed as faulty.

\begin{equation}
\vec{N}_{rw}^{demand} - \vec{N}_{rw}^{actual} = 
\vec{N}_{rw}^{diff}
\end{equation}

\begin{equation}
\pm \vec{N}_{rw}^{diff}  \stackrel{?}{\approx} \vec{axis} 
\end{equation}


\todo{mention unit vector notation, decide notation for axis, express axis according to q}

Note: the lag for torque change and wheel saturation has to be taken into account separately, as those don't count as faults. 
Thresholds should be applied.

\section{Magneto torquers  fault detection}
\subsection{Unknown Input Observer (UIO)}
Uncertainties and modeling errors may cause discrepancies between the actual system and the descriptor mathematical model. Linearization and simplifications which make the system more manageable may lead also to uncertainties. All these uncertainties can have an effect on the system dynamic behavior through the input signals.   
A residual, fault indicator, based on observer design can be robust regarding the unknown input signals by making the effect of unknown inputs(UI) insensitive to the residual and thus making possible to maximize the detectability of a fault. The dynamic equation of the system can be written as
%
\begin{equation}
\dot{x} = \underline Ax+\underline B u+\underline Ed
\label{stateObs}
\end{equation}
\begin{equation}
y = \underline C x
\end{equation}
%
where $\underline A$ ,$\underline B$ and $ \underline C $ are the system matrix, input and output matrix respectively and $\underline E$ is the distribution matrix of the unknown input or disturbance vector $d$. Furthermore, $x$ is the state vector $u$ is the input vector and $y$ is the output vector. The time dependency of the variables has been suppressed in order to relax the notation. Following \cite{UIO} 
%
%
\\
\textit{An observer is defined as Unknown Input Observer for a system described by \eqref{stateObs} if the state estimation error vector $e$ approaches zero asymptotically regardless of the presence of the unknown input }
\\
The full order observer
\begin{equation}
\dot{z} = \underline Fz+\underline{TB} u+\underline Ky
\label{stateObs1}
\end{equation}
\begin{equation}
\hat{x} = z + \underline H x
\end{equation}