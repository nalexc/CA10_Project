\chapter{Control Schemes}

\begin{figure}[h!]
	\centering 
	\includegraphics[width=170mm]{figures/mainLoop.pdf}	
	\caption{Main Control Loop.}
	\label{label{fig:mainLoop}}
\end{figure}
\todo{add reference omega and q to figure}

The proposed control scheme has a hierarchical, modular structure. The main attitude controller outputs a torque reference for the actuators, which is then distributed by lower level controllers. This means that the attitude controller can be swapped without having to modify the lower level controllers. The desaturation controller distributes the torque between the reaction wheels and magnetorquers. The reaction wheel subsystem executes local fault detection and fault isolation. It receives a 3 dimensional torque demand and distributes it between the individual reaction wheel motors. The reaction wheels subsystem checks fault residual signals and adjusts torque distribution between reaction wheels accordingly. 

\todo{evaluation of station tracking precision - should be within $1\deg$. Compare different reaction wheel configurations}

		\begin{equation}
		\underline{I}_{s}\vec{\dot{\omega}} + \underline{\omega}^\times\underline{I}_{s}\vec{\omega} = -\vec{\dot{h}}_{rw} -  \underline{\omega}^\times \vec{{h}}_{rw} + \vec{N_{mt}}  + \vec{N_{dist}} =  -  \underline{\omega}^\times \vec{{h}}_{rw} + \vec{N_{rw}} + \vec{N_{mt}}  + \vec{N_{dist}} = \vec{u} 
		\end{equation}
		
		Compensation for $\underline{\omega}^\times \vec{{h}}_{rw}$ for torque demand inputs \todo{compensation} 

\input{chapters/desaturation.tex}
\input{chapters/previouscontrollers.tex}
\input{chapters/SlidingMode.tex}
\input{chapters/StateFeedback.tex}
\input{chapters/globalAttitudeControl.tex}